# Communication Signoff
## FUNCTION OF THE SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Communication subsystem is responsible for exchanging data across and allows for access to the Internet.  Without this subsystem, wireless gathering of data would be infeasible.  This component will integrate with the microcontroller and act as a liaison or mouth for the device.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The type of communication that would work best would be the Global System for Mobile Communication (GSM) which is a standard to describe the telecommunications protocols used by mobile and cellular device communications across digital cellular networks.  More common terms that are thrown around are “2G” and “3G” standing for 2nd-Generation and 3rd-Generation digital cellular networks respectively.  The reasoning behind the decision to utilize this type of communication is the near global infrastructure already set in place.  There are exceptions to this, but in terms of coverage, GSM will be an expansive choice.  
## CONSTRAINTS ON THE SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  The constraints given below are generalized to allow for comparison of any potential contender for the microcontroller.  Constraints on the subsystem are as follows:
1. The component must be able to utilize GSM communication in 4G.  GSM operating frequency is a range of 850 MHz to 1900 MHz.  This is the chosen method of accessing the Internet due to its coverage and support in place.
2. The component must have a slot and support for a micro Subscriber Identity Module card (SIM).  This card contains identification information related to the device that allows a specified mobile network to pinpoint its location.  Without this, the device will be unable to send data to the mobile networks and, by extension, the Internet.
3. Price for this component should remain under $100 as this can quickly become a very expensive component, but it needs a limit and to be included for wireless communication.  
4. The component must support communication with other components.  To do this, Serial Peripheral Interface (SPI), Universal Asynchronous Receiver/Transmitter (UART), or some form of hardware communication will need to be achievable on the board.  SPI is a synchronous method while UART is an asynchronous method for two devices connected over a short distance to liaise.
5. There must be sufficient memory space for supporting the operating code.  It is unknown how much memory the code will occupy. Comparing similar operating code with libraries and compilation show slightly over or under 120 KB (Kilobytes) in Flash/Disk/Storage. To account for the worst case, the board will need over 120 KB.  
6. The component will need to have coding language support for C and or Python. Support for both is preferred for options and coverage but not required. It is expected that the users will have some degree of coding experience and may potentially personalize or improve upon the code. These languages are chosen due to popularity and performance. C, in particular, is predicted to be very desirable for this project.
7. The manufacturer needs to be a reputable and safe choice. A stable manufacturere that is assumed to remain in business for years to come and continue producing the chosen board is a necessecity. This project aims for replicability, so a board that remains relevant and available is a key part.
8. The cpu clock speed is not a priority for this subsystem due to its nature.  The component will spend a lot of time waiting and does not require heavy computation.  A cpu clock speed above 1 KHz is acceptable.  The cpu speed just needs to be reliable and to get the job done fast enough.
9. The component should keep its general operations under 100 mW.  This is from a given input of 5 V and 20 mA current from the power supply.  Going over 100 mW unnecessarily would drain the battery too quickly.

## BUILDABLES OF SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shown is the pseudo-code for the operating code.  The final form of the code may have parts added and additional functionalities included, but this is the general idea of how the code should flow.  Proceeding from each section is assuming that there are no errors detected indicating a “Success”.  If an error arises, a default handler will need to be called to assess the situation.  It should also be noted that the loop is intended to be theoretically infinite, however, there is an implicit exit at the shutoff button being pushed.  “Timers” refers to physical or software timers that act as a "Watchdog" to prevent the system from hanging on a bad or failed connection. Once a timer is triggered, an interrupt should start and take over to see what is taking so long.  It will then most likely close the connection and return to the loop to try again.
![Psued-Code_Comm](https://github.com/JoshuaEgwuatu/Capstone-Spring2023-CitizenAirQualitySensor/blob/main/Documentation/Images/Psuedo-code_Comm.JPG)
## ANALYSIS OF CHOSEN COMPONENT(S)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The team has chosen to look at the Arduino MKR GSM 1400 to fulfill the needs of the communications subsystem.  It is a small board that takes advantage of the cellular networks to transfer and exchange data wirelessly.  This component will satisfy the previously listed constraints and jobs of this subsystem.  Following are the corresponding fulfillment of the constraints:
1. The Arduino MKR GSM 1400 is able to fully utilize GSM to communicate and transmit data throughout the Internet.  The carrier frequencies are 850 MHz, 1800 MHz, and 1900 MHz which puts it within range of the standard GSM.  This component uses 3rd-Generation (3G) cellular networks to communicate.  
2. There is a slot for a micro-SIM card on the component. 
3. With a price of $83.50, it falls under the $100 limit.
4. There are two ports for communication with other components.  One is a UART and the other is a SPI.  Both are fully supported and will provide adequate means of data exchange with the microcontroller.
5. There is 256 KB of Flash, 8 KB of SRAM, and 4 KB of EEPROM.  The Flash memory is more than needed and the SRAM is not needed to be larger for the needs of this subsystem.  Having the Flash memory being this size is nice in case the operating code is bigger than expected in the end.
6. The Arduino MKR GSM 1400 supports C and Python with many publicly available libraries. 
7. Arduino is a very popular and respected manufacturing and electronics design company.  They were established in 2005 and have had a lot of support throughout the years.  It is expected for them to persist for quite some time.
8. The cpu clock speed runs at a frequency of 32.768 KHz.  This will do for the needs of this subsystem given that not many computations will need to be done.  
9. The Board Power Supply needs 5 V with a Circuit Operating Voltage at 3.3 V.  The DC Current per Input/Output Pin is 7 mA.  This puts the board at a general power draw of 35mW.   It should be noted however, that some GSM handshakes can take up to 2 A from the pins.  Special connections will need to be made for reaching this level of current as some boards are at risk of harm from this level of current.
## BILL OF MATERIALS (BOM)
| Designator | Manufacturer | Manufactured Part # | Description                                                                                                 | Quantity | Price Each |
| ---------- | ------------ | ------------------- | ----------------------------------------------------------------------------------------------------------- | -------- | ---------- |
| U1         | Maduino      | TEL0124             | Maduino Zero 4G LTE CAT4 (SIM7600A-H) Shield (Cellular Communication Device for Wireless Data Transmission) | 1        | $64.80     |
