# Communication Signoff
## FUNCTION OF THE SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Communication subsystem is responsible for exchanging data across and allows for access to the Internet.  Without this subsystem, wireless gathering of data would be infeasible.  The end goal is to enable the Web system to receive data from the device and store it for later access.  The way this can be done is by implementing a component with some form of wireless communication capabilities.  This component will integrate with the microcontroller and act as a liaison or mouth for the device.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The type of communication that would work best would be the Global System for Mobile Communication (GSM) which is a standard to describe the telecommunications protocols used by mobile and cellular device communications across digital cellular networks.  More common terms that are thrown around are “2G” and “3G” standing for 2nd-Generation and 3rd-Generation digital cellular networks respectively.  The reasoning behind the decision to utilize this type of communication is the near global infrastructure already set in place.  There are exceptions to this, but in terms of coverage, GSM will be an expansive choice.  
## CONSTRAINTS ON THE SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The subsystem constraints are placed to ensure that it can fulfill its job in a satisfactory manner.  The constraints given below are generalized to allow for comparison of any potential contender for the microcontroller.  Constraints on the subsystem are as follows:
1. The main job of this subsystem is to be a component that can transfer data to the Internet accurately.  The component must be able to do this.
2. The component must be able to utilize GSM communication in either 2G or 3G.  GSM operating frequency is a range of 850 MHz to 1900 MHz.  This is the chosen method of accessing the Internet due to its coverage and support in place.
3. The component must have a slot and support for a micro Subscriber Identity Module card (SIM).  This card contains identification information related to the device that allows a specified mobile network to pinpoint its location.  Without this, the device will be unable to send data to the mobile networks and, by extension, the Internet.
4. Pricing for these types of components can quickly reach above $50.  Staying under $100 would be ideal.  This is one of the more expensive subsystems, so the price being slightly high is acceptable.  
5. The component must support communication with other components.  To do this, Serial Peripheral Interface (SPI), Universal Asynchronous Receiver/Transmitter (UART), or some form of hardware communication will need to be achievable on the board.  SPI is a synchronous method while UART is an asynchronous method for two devices connected over a short distance to liaise.
6. There must be sufficient memory space for supporting the operating code.  Given that the operating code has not been written yet, going off the estimated, worst-case scenario, the component will need to have at least 150 KB of Flash/Disk/Storage.  
7. The component will need to have coding language support for assembly, C, and or Python.  It is expected that the users will have some degree of coding experience and may potentially personalize or improve upon the code. These languages are chosen due to popularity and performance.  C, in particular, is predicted to be very desirable for this project. 
8. The manufacturer needs to be a reputable and safe choice.  Choosing a bad manufacturer could hurt the project.  A stable choice will lower the risk of receiving a malfunctioning board or running out of the specified board supply.  This device is planned to be open to public use and construction, so it will need to be trustworthy.
9. The cpu clock speed is not a priority for this subsystem due to its nature.  The component will spend a lot of time waiting and does not require heavy computation.  A cpu clock speed above 1 KHz is acceptable.  
10. The component cannot have a power draw big enough to inhibit operational times being long enough or force an upgrade to the power subsystem.  Keeping general operations under 100 mW is preferred.  This is from a given input of 5 V and 20 mA current from the power supply.  

## BUILDABLES OF SUBSYSTEM
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shown is the pseudo-code for the operating code.  The final form of the code may have parts added and additional functionalities included, but this is the general idea of how the code should flow.  Proceeding from each section is assuming that there are no errors detected indicating a “Success”.  If an error arises, a default handler will need to be called to assess the situation.  It should also be noted that the loop is intended to be theoretically infinite, however, there is an implicit exit at the shutoff button being pushed.  “Timers” refers to physical or software timers that act as a "Watchdog" to prevent the system from hanging on a bad or failed connection. Once a timer is triggered, an interrupt should start and take over to see what is taking so long.  It will then most likely close the connection and return to the loop to try again.
![Psued-Code_Comm](https://github.com/JoshuaEgwuatu/Capstone-Spring2023-CitizenAirQualitySensor/blob/main/Documentation/Images/Psuedo-code_Comm.JPG)
## ANALYSIS OF CHOSEN COMPONENT(S)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The team has chosen to look at the Arduino MKR GSM 1400 to fulfill the needs of the communications subsystem.  It is a small board that takes advantage of the cellular networks to transfer and exchange data wirelessly.  This component will satisfy the previously listed constraints and jobs of this subsystem.  Following are the corresponding fulfillment of the constraints:
1. The Arduino MKR GSM 1400 is able to fully utilize GSM to communicate and transmit data throughout the Internet.  The carrier frequencies are 850 MHz, 1800 MHz, and 1900 MHz which puts it within range of the standard GSM.  This component uses 3rd-Generation (3G) cellular networks to communicate.  
2. There is a slot for a micro-SIM card on the component.  It is located on the bottom of the board with a locking mechanism to prevent the card from falling out.
3. With a price of $83.50, it is on the more expensive side, but the quality and services provided are more than adequate.  The price falls under the $100 limit and is acceptable.  There is an optional SIM card bundle, but they will begin charging right away and only offer Arduino Cloud services.  It is an important distinction when purchasing to not opt for this bundle.
4. There are two ports for communication with other components.  One is a UART and the other is a SPI.  Both are fully supported and will provide adequate means of data exchange with the microcontroller.
5. There is 256 KB of Flash, 8 KB of SRAM, and 4 KB of EEPROM.  The Flash memory is more than needed and the SRAM is not needed to be larger for the needs of this subsystem.  Having the Flash memory being this size is nice in case the operating code is bigger than expected in the end.
6. The Arduino MKR GSM 1400 supports C and Assembly.  Python may also be supported with a special compiler.  There are many libraries made publicly available in these languages.  This is especially true for C.  
7. Arduino is a very popular and respected manufacturing and electronics design company.  They were established in 2005 and have had a lot of support throughout the years.  It is expected for them to persist for quite some time.
8. The cpu clock speed runs at a frequency of 32.768 KHz.  This will do for the needs of this subsystem given that not many computations will need to be done.  
9. The Board Power Supply needs 5 V with a Circuit Operating Voltage at 3.3 V.  The DC Current per Input/Output Pin is 7 mA.  This puts the board at a general power draw of 35mW.   It should be noted however, that some GSM handshakes can take up to 2 A from the pins.  Special connections will need to be made for reaching this level of current regardless of components chosen as boards are at risk of harm from this level of current.
## BILL OF MATERIALS (BOM)
|Designator|Manufactured Part #|Quantity|Description|Price|
|----------|-------------------|--------|-----------|-----|
|U1|ABX00018|1|Arduino MKR GSM 1400 (Cellular Communication Device for Wireless Data Transmission)|$83.50|
